{
  "swagger": "2.0",
  "info": {
    "title": "OCF Cloud API for Cloud Services",
    "version": "0.0.3-20190828",
    "license": {
      "name": "Copyright 2019 Open Connectivity Foundation, Inc. All rights reserved.",
      "x-description": "Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n        1.  Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n        2.  Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\n        THIS SOFTWARE IS PROVIDED BY THE Open Connectivity Foundation, INC. \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE OR WARRANTIES OF NON-INFRINGEMENT, ARE DISCLAIMED.\n        IN NO EVENT SHALL THE Open Connectivity Foundation, INC. OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n        HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n"
    }
  },
  "host": "api.example.com",
  "schemes": [
    "https"
  ],
  "tags": [
    {
      "name": "Devices",
      "description": "Basic information about devices"
    },
    {
      "name": "Resources",
      "description": "Read or change the configuration of the device"
    },
    {
      "name": "Events",
      "description": "Be notified about changes occuring on the device"
    }
  ],
  "paths": {
    "/api/v1/devices?content=base": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/Accept"
        },
        {
          "$ref": "#/parameters/BatchFormat"
        }
      ],
      "get": {
        "tags": [
          "Devices"
        ],
        "summary": "Get all devices with resource links",
        "description": "Get meta-information, including Resource Links, for all Devices which are signed up to the OCF Cloud - either \"online\" or \"offline\". Devices which are \"online\" are signed in to the system and are accessible. Offline devices are signed up to the system, but currently disconnected.",
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "An array of devices",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Device"
              }
            }
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          },
          "503": {
            "$ref": "#/responses/ServiceUnavailable"
          },
          "504": {
            "$ref": "#/responses/GatewayTimeout"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices?content=all": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/Accept"
        },
        {
          "$ref": "#/parameters/BatchFormat"
        }
      ],
      "get": {
        "tags": [
          "Devices"
        ],
        "summary": "Get all devices with resource representations",
        "description": "Get meta-information, including Resource Representations, for all Devices which are signed up to the OCF Cloud - either \"online\" or \"offline\". Devices which are \"online\" are signed in to the system and are accessible. Offline devices are signed up to the system, but currently disconnected.",
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "An array of devices",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/DeviceContentAll"
              }
            }
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          },
          "503": {
            "$ref": "#/responses/ServiceUnavailable"
          },
          "504": {
            "$ref": "#/responses/GatewayTimeout"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/subscriptions": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/Accept"
        }
      ],
      "post": {
        "tags": [
          "Events"
        ],
        "summary": "Subscribe to events against the set of devices",
        "description": "Subscribe to devices events by providing \"eventTypes\" you're interested in and an \"eventsUrl\" endpoint where notifications will be sent to as defined. A successful response contains a \"subscriptionId\" which identifies the registered subscription and is part of each notification. First notification for each registered event type is received immediately after subscription and contains the actual state of the resource, followed by new notifications in case of any change.\n\nSupported events:\n- \"devices_registered\"\n- \"devices_unregistered\"\n- \"devices_online\"\n- \"devices_offline\"",
        "parameters": [
          {
            "$ref": "#/parameters/ContentType"
          },
          {
            "$ref": "#/parameters/SubscribeRequestDevices"
          }
        ],
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "201": {
            "$ref": "#/definitions/SubscribeResponse"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/subscriptions/{subscriptionId}": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/SubscriptionIdPath"
        }
      ],
      "delete": {
        "tags": [
          "Events"
        ],
        "summary": "Unsubscribe from events against the set of devices",
        "description": "Cancel the subscription identified by the provided \"subscriptionId\" that was returned in the response to the subscription request.",
        "responses": {
          "202": {
            "description": "Subscription was marked for cancellation"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/{deviceId}?content=base": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/Accept"
        },
        {
          "$ref": "#/parameters/DeviceId"
        },
        {
          "$ref": "#/parameters/BatchFormat"
        }
      ],
      "get": {
        "tags": [
          "Devices"
        ],
        "summary": "Get the device with resource links by ID",
        "description": "Get the meta-information for the Device given by the provided \"deviceId\" including Resource Links.",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "Device requested with content=base query parameter",
            "schema": {
              "$ref": "#/definitions/Device"
            }
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          },
          "503": {
            "$ref": "#/responses/ServiceUnavailable"
          },
          "504": {
            "$ref": "#/responses/GatewayTimeout"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/{deviceId}?content=all": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/Accept"
        },
        {
          "$ref": "#/parameters/DeviceId"
        },
        {
          "$ref": "#/parameters/BatchFormat"
        }
      ],
      "get": {
        "tags": [
          "Devices"
        ],
        "summary": "Get the device with resource representations by ID",
        "description": "Get the meta-information for the Device given by the provided \"deviceId\" including Resource Representations.",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "200": {
            "description": "Device requested with content=all query parameter",
            "schema": {
              "$ref": "#/definitions/DeviceContentAll"
            }
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          },
          "503": {
            "$ref": "#/responses/ServiceUnavailable"
          },
          "504": {
            "$ref": "#/responses/GatewayTimeout"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/{deviceId}/subscriptions": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/DeviceId"
        },
        {
          "$ref": "#/parameters/Accept"
        }
      ],
      "post": {
        "tags": [
          "Events"
        ],
        "summary": "Subscribe to events against a specific device",
        "description": "Subscribe to Device level events by providing \"eventTypes\" you're interested in and an \"eventsUrl\" API Endpoint where notifications will be sent to as defined. A successful response contains a \"subscriptionId\" which identifies the registered subscription and is part of each notification. First notification for each registered event type is received immediately after subscription and contains the actual state of the resource, followed by new notifications in case of any change.\n\nSupported events:\n- \"resources_published\"\n- \"resources_unpublished\"",
        "parameters": [
          {
            "$ref": "#/parameters/ContentType"
          },
          {
            "$ref": "#/parameters/SubscribeRequestDevice"
          }
        ],
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "201": {
            "$ref": "#/definitions/SubscribeResponse"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/{deviceId}/subscriptions/{subscriptionId}": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/DeviceId"
        },
        {
          "$ref": "#/parameters/SubscriptionIdPath"
        }
      ],
      "delete": {
        "tags": [
          "Events"
        ],
        "summary": "Unsubscribe from events against a specific device",
        "description": "Cancel the subscription identified by the provided \"subscriptionId\" that was returned in the response to the subscription request.",
        "responses": {
          "202": {
            "description": "Subscription was marked for cancellation"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/{deviceId}/{resourceLinkHref}": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/DeviceId"
        },
        {
          "$ref": "#/parameters/ResourceLinkHref"
        },
        {
          "$ref": "#/parameters/Accept"
        }
      ],
      "get": {
        "tags": [
          "Resources"
        ],
        "summary": "Retrieve resource values",
        "description": "Get or update the Resource Representation of the Resource found at \"resourceLinkHref\" on the Device with the given \"deviceId\"",
        "consumes": [
          "application/json",
          "application/vnd.ocf+cbor"
        ],
        "produces": [
          "application/json",
          "application/vnd.ocf+cbor"
        ],
        "responses": {
          "200": {
            "$ref": "#/definitions/ResourceRetrieveResponse"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          },
          "503": {
            "$ref": "#/responses/ServiceUnavailable"
          },
          "504": {
            "$ref": "#/responses/GatewayTimeout"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      },
      "post": {
        "tags": [
          "Resources"
        ],
        "summary": "Update resource values",
        "parameters": [
          {
            "$ref": "#/parameters/ResourceUpdateRequest"
          },
          {
            "$ref": "#/parameters/ContentType"
          }
        ],
        "consumes": [
          "application/json",
          "application/vnd.ocf+cbor"
        ],
        "produces": [
          "application/json",
          "application/vnd.ocf+cbor"
        ],
        "responses": {
          "200": {
            "$ref": "#/definitions/ResourceRetrieveResponse"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          },
          "415": {
            "$ref": "#/responses/UnsupportedMediaType"
          },
          "503": {
            "$ref": "#/responses/ServiceUnavailable"
          },
          "504": {
            "$ref": "#/responses/GatewayTimeout"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*",
              "w:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/{deviceId}/{resourceLinkHref}/subscriptions": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/DeviceId"
        },
        {
          "$ref": "#/parameters/ResourceLinkHref"
        },
        {
          "$ref": "#/parameters/Accept"
        }
      ],
      "post": {
        "tags": [
          "Events"
        ],
        "summary": "Subscribe to events against a specific resource",
        "description": "Subscribe to Resource level events by providing \"eventTypes\" you're interested in and \"eventsUrl\" API Endpoint where notifications will be sent to as defined. A successful response contains a \"subscriptionId\" which identifies the registered subscription and is part of each event. First notification for each registered event type is received immediately after subscription and contains the actual state of the resource, followed by new notifications in case of any change.\n \nSupported events:\n- \"resource_contentchanged\"",
        "parameters": [
          {
            "$ref": "#/parameters/ContentType"
          },
          {
            "$ref": "#/parameters/SubscribeRequestResources"
          }
        ],
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "responses": {
          "201": {
            "$ref": "#/definitions/SubscribeResponse"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          },
          "406": {
            "$ref": "#/responses/NotAcceptable"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/api/v1/devices/{deviceId}/{resourceLinkHref}/subscriptions/{subscriptionId}": {
      "parameters": [
        {
          "$ref": "#/parameters/CorrelationId"
        },
        {
          "$ref": "#/parameters/DeviceId"
        },
        {
          "$ref": "#/parameters/ResourceLinkHref"
        },
        {
          "$ref": "#/parameters/SubscriptionIdPath"
        }
      ],
      "delete": {
        "tags": [
          "Events"
        ],
        "summary": "Unsubscribe from events against a specific resource",
        "description": "Cancel the subscription identified by the provided \"subscriptionId\" that was returned in the response to the subscription request.",
        "responses": {
          "202": {
            "description": "Subscription was marked for cancellation"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "401": {
            "$ref": "#/responses/Unauthorized"
          },
          "403": {
            "$ref": "#/responses/Forbidden"
          },
          "404": {
            "$ref": "#/responses/NotFound"
          }
        },
        "security": [
          {
            "oauth2": [
              "r:*"
            ]
          }
        ]
      }
    },
    "/{eventsUrl}": {
      "post": {
        "tags": [
          "Events"
        ],
        "summary": "Events endpoint provided by the subscriber, where events are delivered",
        "description": "Events endpoint provided during subscription where notifications for the events specified in the subscription will be sent to  as defined per event type. Confirmation of each notification sent to the \"eventsUrl\" endpoint is required with a \"2xx\" success code.\n\nNotifications you may receive based on the event type you're subscribed to are:\n - \"subscription_cancelled\": \"SubscriptionCancelledEvent\"\n - \"devices_registered\": \"DevicesRegisteredEvent\"\n - \"devices_unregistered\": \"DevicesUnregisteredEvent\"\n - \"resources_published\": \"ResourcesPublishedEvent\"\n - \"resources_unpublished\": \"ResourcesUnpublishedEvent\"\n - \"devices_online\": \"DevicesOnlineEvent\"\n - \"devices_offline\": \"DevicesOfflineEvent\"\n - \"resource_contentchanged\": \"ResourceContentChangedEvent\"",
        "parameters": [
          {
            "$ref": "#/parameters/CorrelationId"
          },
          {
            "$ref": "#/parameters/ContentType"
          },
          {
            "$ref": "#/parameters/EventType"
          },
          {
            "$ref": "#/parameters/SubscriptionId"
          },
          {
            "$ref": "#/parameters/SequenceNumber"
          },
          {
            "$ref": "#/parameters/EventSignature"
          },
          {
            "$ref": "#/parameters/EventTimestamp"
          },
          {
            "$ref": "#/parameters/EventsUrl"
          },
          {
            "$ref": "#/parameters/Event"
          }
        ],
        "consumes": [
          "application/json",
          "application/vnd.ocf+cbor"
        ],
        "responses": {
          "200": {
            "description": "Event successfully recieved"
          },
          "400": {
            "$ref": "#/responses/BadRequest"
          },
          "410": {
            "description": "The subscription identified by the Subscription-ID header is no more in demand and shall be cancelled"
          }
        }
      }
    }
  },
  "securityDefinitions": {
    "oauth2": {
      "type": "oauth2",
      "flow": "accessCode",
      "authorizationUrl": "https://example.com/api/oauth/dialog",
      "tokenUrl": "https://example.com/api/oauth/token",
      "scopes": {
        "r:*": "Read device data",
        "w:*": "Update content of published resource"
      }
    }
  },
  "parameters": {
    "CorrelationId": {
      "name": "Correlation-ID",
      "in": "header",
      "type": "string",
      "format": "uuid",
      "description": "A Correlation ID, also known as a Transit ID, is a unique identifier value that is attached to requests and messages that allow reference to a particular transaction or event chain.\n"
    },
    "ContentType": {
      "name": "Content-Type",
      "in": "header",
      "type": "string",
      "enum": [
        "application/json",
        "application/vnd.ocf+cbor"
      ],
      "required": true,
      "description": "The Content-Type header is used to indicate the media type of the resource. In responses, a Content-Type header tells the client what the content type of the returned content actually is. In requests, (such as POST), the client tells the server what type of data is actually sent.\n"
    },
    "Accept": {
      "name": "Accept",
      "in": "header",
      "type": "string",
      "enum": [
        "application/json",
        "application/vnd.ocf+cbor"
      ],
      "description": "The Accept request header can be used to specify certain media types which are acceptable for the response. Accept headers can be used to indicate that the request is specifically limited to a small set of desired types.\n"
    },
    "SubscriptionId": {
      "name": "Subscription-ID",
      "in": "header",
      "description": "Unique id of the subscription",
      "type": "string",
      "format": "uuid",
      "required": true
    },
    "SequenceNumber": {
      "name": "Sequence-Number",
      "in": "header",
      "description": "Sequence number of the event; first event starting with number 0",
      "type": "string",
      "required": true
    },
    "EventSignature": {
      "name": "Event-Signature",
      "in": "header",
      "description": "The signature created by combining the `signingSecret` from the subscription request, headers and the body of the request using a stanard HMAC-SHA256 keyed hash.",
      "type": "string",
      "required": true
    },
    "EventTimestamp": {
      "name": "Event-Timestamp",
      "in": "header",
      "description": "Time when the event occurred in standard Unix time format",
      "type": "string",
      "required": true
    },
    "EventType": {
      "name": "Event-Type",
      "in": "header",
      "type": "string",
      "enum": [
        "subscription_cancelled",
        "devices_registered",
        "devices_unregistered",
        "resource_contentchanged",
        "resources_published",
        "resources_unpublished",
        "devices_online",
        "devices_offline"
      ],
      "required": true
    },
    "DeviceType": {
      "description": "Filter devices by device type",
      "name": "rt",
      "in": "query",
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "ResourceLinkHref": {
      "description": "Path to resource",
      "name": "resourceLinkHref",
      "in": "path",
      "type": "string",
      "required": true
    },
    "DeviceId": {
      "description": "Id of the device",
      "name": "deviceId",
      "in": "path",
      "type": "string",
      "format": "uuid",
      "required": true
    },
    "SubscriptionIdPath": {
      "name": "subscriptionId",
      "in": "path",
      "type": "string",
      "format": "uuid",
      "required": true
    },
    "BatchFormat": {
      "name": "content",
      "in": "query",
      "description": "Indicates to the recipient that the response payload shall be the resolved (i.e. resource representation) Link and not the Link itself. Default is `base`. When requesting `all`, additional scope `r:*` is required",
      "type": "string",
      "enum": [
        "base",
        "all"
      ]
    },
    "EventsUrl": {
      "name": "eventsUrl",
      "type": "string",
      "in": "path",
      "required": true
    },
    "ResourceUpdateRequest": {
      "description": "Map of resource values encoded to application/vnd.ocf+cbor type",
      "name": "content",
      "in": "body",
      "schema": {
        "$ref": "#/definitions/ResourceUpdateRequest"
      },
      "required": true
    },
    "SubscribeRequestDevices": {
      "name": "content",
      "in": "body",
      "schema": {
        "$ref": "#/definitions/SubscribeRequestDevices"
      },
      "required": true
    },
    "SubscribeRequestDevice": {
      "name": "content",
      "in": "body",
      "schema": {
        "$ref": "#/definitions/SubscribeRequestDevice"
      },
      "required": true
    },
    "SubscribeRequestResources": {
      "name": "content",
      "in": "body",
      "schema": {
        "$ref": "#/definitions/SubscribeRequestResources"
      },
      "required": true
    },
    "Event": {
      "description": "Event of a specific type, based on what you are subscribed to",
      "name": "content",
      "in": "body",
      "schema": {
        "$ref": "#/definitions/ResourceContentChangedEvent"
      },
      "required": true
    }
  },
  "responses": {
    "Unauthorized": {
      "description": "Unauthorized"
    },
    "NotFound": {
      "description": "Not found"
    },
    "SubscriptionCancellationPending": {
      "description": "Subscription was marked for cancellation"
    },
    "Forbidden": {
      "description": "Insufficient permissions"
    },
    "BadRequest": {
      "description": "The request was malformed or badly constructed"
    },
    "ServiceUnavailable": {
      "description": "The service on the Target Cloud is unavailable for the reason indicated in the diagnostic payload"
    },
    "GatewayTimeout": {
      "description": "The target Device is registered at the target Cloud, however the Device itself is unavailable, offline, or otherwise unreachable. The response should include a Retry-After header containing the time after which the request may be re-attempted. Additional information is indicated in the diagnostic payload."
    },
    "UnsupportedMediaType": {
      "description": "The request contained an unsupported media type in the Content-Type header"
    },
    "NotAcceptable": {
      "description": "The server cannot honour the Content-Type requested in the Accept header"
    }
  },
  "definitions": {
    "DeviceProperties": {
      "type": "object",
      "required": ["rt", "di", "dmn", "n"],
      "properties": {
        "rt":  {
          "description": "Resource Type of the Resource",
          "items": {
            "type": "string",
            "maxLength": 64
          },
          "minItems": 1,
          "readOnly": true,
          "uniqueItems": true,
          "type": "array"
        },
        "di": {
          "allOf": [
            {
              "$ref" : "http://openconnectivityfoundation.github.io/core/schemas/oic.types-schema.json#/definitions/uuid"
            },
            {
              "description": "Unique identifier for the Device",
              "readOnly": true
            }
          ]
        },
        "dmn":  {
          "description": "Manufacturer Name.",
          "items": {
            "properties": {
              "language": {
                "allOf": [
                  {
                    "$ref" : "http://openconnectivityfoundation.github.io/core/schemas/oic.types-schema.json#/definitions/language-tag"
                  },
                  {
                    "description": "An RFC 5646 language tag.",
                    "readOnly": true
                  }
                ]
              },
              "value": {
                "description": "Manufacturer name in the indicated language.",
                "maxLength": 64,
                "readOnly": true,
                "type": "string"
              }
            },
            "type": "object"
          },
          "minItems": 1,
          "readOnly": true,
          "type": "array"
        },
        "n":  {
          "$ref" : "https://openconnectivityfoundation.github.io/core/schemas/oic.common.properties.core-schema.json#/definitions/n"
        }
      }
    },
    "Device": {
      "type": "object",
      "required": ["device", "status", "links"],
      "properties": {
        "device": {
          "$ref":"#/definitions/DeviceProperties"
        },
        "status": {
          "$ref": "#/definitions/DeviceStatus"
        },
        "links": {
          "type": "array",
          "items": {
            "$ref": "http://openconnectivityfoundation.github.io/core/swagger2.0/oic.wk.res.swagger.json#/definitions/oic.oic-link"
          }
        }
      },
      "example": {
        "device": {
          "rt": ["oic.wk.d","oic.d.sensor"],
          "dmn": [{"language":"en", "value":"Open Connectivity Foundation"}],
          "n": "Food safety sensor",
          "di": "53080a4f-5e3e-4291-802f-3436238232d2"
        },
        "status": "online",
        "links": [
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/oic/d",
            "rt": [
              "oic.wk.d",
              "oic.d.sensor"
            ],
            "if": [
              "oic.if.r",
              "oic.if.baseline"
            ]
          },
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/oic/p",
            "rt": [
              "oic.wk.p"
            ],
            "if": [
              "oic.if.r",
              "oic.if.baseline"
            ]
          },
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/humidity",
            "rt": [
              "oic.r.humidity"
            ],
            "if": [
              "oic.if.s",
              "oic.if.baseline"
            ]
          },
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/temperature",
            "rt": [
              "oic.r.temperature"
            ],
            "if": [
              "oic.if.s",
              "oic.if.baseline"
            ]
          }
        ]
      }
    },
    "DeviceContentAll": {
      "type": "object",
      "required": ["device", "status", "links"],
      "properties": {
        "device": {
          "$ref":"#/definitions/DeviceProperties"
        },
        "status": {
          "$ref": "#/definitions/DeviceStatus"
        },
        "links": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "href": {
                "type": "string"
              },
              "rep": {
                "oneOf": [
                  {
                    "type": "object"
                  },
                  {
                    "type": "array"
                  }
                ]
              }
            }
          }
        }
      },
      "example": {
        "device": {
          "rt": ["oic.wk.d","oic.d.sensor"],
          "dmn": [{"language":"en", "value":"Open Connectivity Foundation"}],
          "n": "Food safety sensor",
          "di": "53080a4f-5e3e-4291-802f-3436238232d2"
        },
        "status": "online",
        "links": [
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/oic/d",
            "rep": {
              "rt": ["oic.wk.d","oic.d.sensor"],
              "dmn": [{"language":"en", "value":"Open Connectivity Foundation"}],
              "n": "Food safety sensor",
              "di": "53080a4f-5e3e-4291-802f-3436238232d2",
              "icv":  "ocf.2.0.5",
              "dmv":  "ocf.res.1.3.0, ocf.sh.1.3.0",
              "piid": "6F0AAC04-2BB0-468D-B57C-16570A26AE48"
            }
          },
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/oic/p",
            "rep": {
              "pi":   "54919CA5-4101-4AE4-595B-353C51AA983C",
              "mnfv": "1.1.20"
            }
          },
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/humidity",
            "rep": {
              "humidity": 62,
              "desiredHumidity": 65
            }
          },
          {
            "href": "/53080a4f-5e3e-4291-802f-3436238232d2/temperature",
            "rep": {
              "temperature": 21,
              "units": "C"
            }
          }
        ]
      }
    },
    "DeviceStatus": {
      "description": "Device status available from the OCF Cloud, which tracks if the device has opened TCP connection and is signed in",
      "type": "string",
      "enum": [
        "online",
        "offline"
      ]
    },
    "ResourceUpdateRequest": {
      "type": "string",
      "description": "Desired content of the resource",
      "example": "o29kZXNpcmVkSHVtaWRpdHkYPGV0eXBlc4Fub2ljLnIuaHVtaWRpdHloaHVtaWRpdHkYKA=="
    },
    "ResourceRetrieveResponse": {
      "type": "string",
      "description": "Content of the resource returned from the device",
      "example": "o29kZXNpcmVkSHVtaWRpdHkYPGV0eXBlc4Fub2ljLnIuaHVtaWRpdHloaHVtaWRpdHkYKA=="
    },
    "EventType": {
      "type": "string",
      "enum": [
        "subscription_cancelled",
        "devices_registered",
        "devices_unregistered",
        "resource_contentchanged",
        "resources_published",
        "resources_unpublished",
        "devices_online",
        "devices_offline"
      ]
    },
    "EventTypeDevices": {
      "type": "string",
      "enum": [
        "devices_registered",
        "devices_unregistered",
        "devices_online",
        "devices_offline"
      ]
    },
    "EventTypeDevice": {
      "type": "string",
      "enum": [
        "resources_published",
        "resources_unpublished"
      ]
    },
    "EventTypeResources": {
      "type": "string",
      "enum": [
        "resource_contentchanged"
      ]
    },
    "SubscriptionId": {
      "description": "Unique id of the subscription",
      "type": "string",
      "format": "uuid"
    },
    "SubscribeRequestDevices": {
      "type": "object",
      "properties": {
        "eventsUrl": {
          "$ref": "#/definitions/EventsUrl"
        },
        "eventTypes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/EventTypeDevices"
          }
        },
        "signingSecret": {
          "type": "string",
          "maxLength": 32,
          "minLength": 32
        }
      },
      "required": [
        "eventsUrl",
        "eventTypes",
        "signingSecret"
      ],
      "example": {
        "eventsUrl": "https://events.example.com/",
        "eventTypes": [
          "devices_registered",
          "devices_unregistered"
        ],
        "signingSecret": "3BZ6oI9xbRJzOUvUoRb5RgaZjPqHrmql"
      }
    },
    "SubscribeRequestDevice": {
      "type": "object",
      "properties": {
        "eventsUrl": {
          "$ref": "#/definitions/EventsUrl"
        },
        "eventTypes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/EventTypeDevice"
          }
        },
        "signingSecret": {
          "type": "string",
          "maxLength": 32,
          "minLength": 32
        }
      },
      "required": [
        "eventsUrl",
        "eventTypes",
        "signingSecret"
      ],
      "example": {
        "eventsUrl": "https://events.example.com/",
        "eventTypes": [
          "resource_published",
          "resource_unpublished"
        ],
        "signingSecret": "3BZ6oI9xbRJzOUvUoRb5RgaZjPqHrmql"
      }
    },
    "SubscribeRequestResources": {
      "type": "object",
      "properties": {
        "eventsUrl": {
          "$ref": "#/definitions/EventsUrl"
        },
        "eventTypes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/EventTypeResources"
          }
        },
        "signingSecret": {
          "type": "string",
          "maxLength": 32,
          "minLength": 32
        }
      },
      "required": [
        "eventsUrl",
        "eventTypes",
        "signingSecret"
      ],
      "example": {
        "eventsUrl": "https://events.example.com/",
        "eventTypes": [
          "resource_contentchanged"
        ],
        "signingSecret": "3BZ6oI9xbRJzOUvUoRb5RgaZjPqHrmql"
      }
    },
    "SubscribeResponse": {
      "description": "Subscription was registered, waiting for verification",
      "type": "object",
      "properties": {
        "subscriptionId": {
          "$ref": "#/definitions/SubscriptionId"
        }
      },
      "required": [
        "subscriptionId"
      ],
      "example": {
        "subscriptionId": "1eeb465c-5e8d-4305-a366-bbf035fff671"
      }
    },
    "EventsUrl": {
      "type": "string",
      "format": "url",
      "example": "https://events.example.com/"
    },
    "SubscriptionCancelledEvent": {
      "type": "object",
      "description": "Subscription with provided id was cancelled"
    },
    "DevicesRegisteredEvent": {
      "description": "Device was successfully signed up to the OCF Cloud, as defined in the `oic.sec.account`",
      "type": "object",
      "properties": {
        "content": {
          "type": "array",
          "items": {
            "properties": {
              "di": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        }
      }
    },
    "DevicesUnregisteredEvent": {
      "description": "Device was successfully signed off from the OCF Cloud, as defined in the `oic.sec.account`",
      "type": "object",
      "properties": {
        "content": {
          "type": "array",
          "items": {
            "properties": {
              "di": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        }
      }
    },
    "ResourcesPublishedEvent": {
      "type": "object",
      "properties": {
        "content": {
          "type": "array",
          "items": {
            "$ref": "http://openconnectivityfoundation.github.io/core/swagger2.0/oic.wk.res.swagger.json#/definitions/oic.oic-link"
          }
        }
      }
    },
    "ResourcesUnpublishedEvent": {
      "type": "object",
      "properties": {
        "content": {
          "type": "array",
          "items": {
            "$ref": "http://openconnectivityfoundation.github.io/core/swagger2.0/oic.wk.res.swagger.json#/definitions/oic.oic-link"
          }
        }
      }
    },
    "DevicesOnlineEvent": {
      "type": "object",
      "properties": {
        "content": {
          "type": "array",
          "items": {
            "properties": {
              "di": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        }
      }
    },
    "DevicesOfflineEvent": {
      "type": "object",
      "properties": {
        "content": {
          "type": "array",
          "items": {
            "properties": {
              "di": {
                "type": "string",
                "format": "uuid"
              }
            }
          }
        }
      }
    },
    "ResourceContentChangedEvent": {
      "type": "string",
      "description": "New Content of the resource returned from the device",
      "example": "o29kZXNpcmVkSHVtaWRpdHkYPGV0eXBlc4Fub2ljLnIuaHVtaWRpdHloaHVtaWRpdHkYKA=="
    }
  }
}
